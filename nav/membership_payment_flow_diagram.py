import osfrom diagrams import Diagram, Cluster, Edgefrom diagrams.programming.language import Pythonfrom diagrams.custom import Customfrom diagrams.onprem.analytics import PowerBIcd = os.path.dirname(__file__)chart_dir = cd + '/flow_charts/'file_name, _ = os.path.splitext(os.path.basename(__file__))static_dir = cd + '/static/'_excel_sheet_icon = static_dir + 'excel_sheet.png'_excel_icon = static_dir + 'excel.png'with Diagram('Medlemmskaps ETL', show=False, direction="BT", filename=chart_dir + file_name):    with Cluster('Datagrunnlag.xlsx'):        excel = Custom('', _excel_icon)        members = Custom('Sheet : Medlemmer', _excel_sheet_icon)        membership = Custom('Sheet : Kontigent', _excel_sheet_icon)        payments = Custom('Sheet : Betalinger', _excel_sheet_icon)    with Cluster('datavask'):        duplicates = Custom('duplikater.xlsx', _excel_icon)        invalid_birthdays = Custom('invalid_birthdays.xlsx         ', _excel_icon)    results = Custom('results.xlsx', _excel_icon)    power_bi = PowerBI('Power BI')    python_script = Python('membership_payment_etl')    members >> Edge(color='blue') >> python_script    membership >> Edge(color='blue') >> python_script    payments >> Edge(color='blue') >> python_script    python_script >> Edge(color='red') >> duplicates    python_script >> Edge(color='red') >> invalid_birthdays    python_script >> Edge(color='green') >> results    results >> Edge(color='green') >> power_bi